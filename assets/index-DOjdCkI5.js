(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class k{constructor(){this.header=document.createElement("header");const t=document.createElement("h1");t.innerText="Decision Making Tool",this.header.append(t)}appendTo(t){t.appendChild(this.header)}getElement(){return this.header}}class U{constructor(){this.main=document.createElement("main"),this.main.classList.add("main")}appendTo(t){t.appendChild(this.main)}append(t){this.main.appendChild(t)}}class R{constructor(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("main__wrapper"),this.wrapperMenu=document.createElement("div"),this.wrapperMenu.classList.add("main__menu-wrapper"),this.wrapper.append(this.wrapperMenu)}appendTo(t){t.appendChild(this.wrapper)}append(t){this.wrapper.appendChild(t)}appendToMenu(t){this.wrapperMenu.appendChild(t)}getElement(){return this.wrapper}}function T(s){const t=s.map(e=>{const n=e.textInputElement.id.split("-")[1],i=e.textInputElement.value,o=parseFloat(e.numberInputElement.value);return{id:n,title:i,weight:o}});return localStorage.setItem("options-list",JSON.stringify(t)),t}function v(){const s=localStorage.getItem("options-list");if(s)return JSON.parse(s)}const $=""+new URL("click-DRE_h4JL.wav",import.meta.url).href,H=""+new URL("win1-C-QfgZqh.mov",import.meta.url).href;class D{constructor(t){this.sound=new Audio(t)}play(){this.isEnabled()&&this.sound.play()}isEnabled(){const t=localStorage.getItem("sound");return t===null||t==="true"}}const j=new D(H),u=new D($),a=class a{constructor(){this.liElement=document.createElement("li"),this.labelElement=document.createElement("label"),this.textInputElement=document.createElement("input"),this.numberInputElement=document.createElement("input"),this.deleteButtonElement=document.createElement("button"),this.liElement.classList.add("main__options-item");const t=v();t&&t.length>0&&t.length>a.options.length&&(a.index=parseInt(t[a.options.length].id)-1),a.index+=1,this.labelElement.setAttribute("for",`option-${a.index}`),this.labelElement.textContent=`#${a.index}`,this.textInputElement.id=`option-${a.index}`,this.textInputElement.type="text",this.textInputElement.classList.add("text-input"),this.textInputElement.placeholder="Title",this.numberInputElement.type="number",this.numberInputElement.classList.add("number-input"),this.numberInputElement.placeholder="Weight",this.numberInputElement.min="0",this.deleteButtonElement.textContent="Delete",this.liElement.appendChild(this.labelElement),this.liElement.appendChild(this.textInputElement),this.liElement.appendChild(this.numberInputElement),this.liElement.appendChild(this.deleteButtonElement),this.deleteButtonElement.addEventListener("click",()=>{var n,i;if(u.play(),this.liElement.remove(),a.options.indexOf(this)===a.options.length-1){let o;this.labelElement&&(o=(i=(n=a.options[a.options.length-2])==null?void 0:n.labelElement)==null?void 0:i.innerText.split("#")[1],a.index=parseInt(o)||0)}a.options.splice(a.options.indexOf(this),1),T(a.options)})}getElement(){return this.liElement}appendTo(t){t.appendChild(this.liElement)}setTitleAndWeight(t,e,n){n?this.labelElement.textContent=`#${n}`:this.labelElement.textContent=`#${a.index}`,this.textInputElement.value=t||"",this.numberInputElement.value=e==null?void 0:e.toString()}static createList(t){for(let e of t){const n=new a;n.setTitleAndWeight(e.title,e.weight,e.id),n.appendTo(g.getElement()),a.options.push(n)}}static getIndex(){return a.index}};a.options=[],a.index=0;let d=a;class Y{constructor(){this.div=document.createElement("div"),this.div.classList.add("modal"),this.div.classList.add("hidden"),this.span=document.createElement("span"),this.div.append(this.span),this.line=document.createElement("div"),this.line.classList.add("modal-line"),this.div.append(this.line)}append(t){this.div.append(t)}showWithText(t){this.span.innerText=t,h.getModal().classList.remove("hidden");let e=100;const n=setInterval(()=>{e-=10,h.getLine().style.width=`${e}%`,e<0&&(clearInterval(n),h.getModal().classList.add("hidden"),h.getLine().style.width="100%")},300)}getModal(){return this.div}getLine(){return this.line}}const h=new Y;class q{constructor(){this.ul=document.createElement("ul"),this.ul.classList.add("main__options-list")}appendTo(t){t.append(this.ul)}getElement(){return this.ul}removeChild(){const t=this.ul.childNodes;for(let e of t)setTimeout(()=>{this.ul.removeChild(e)},0)}}class m{constructor(t,e,n){this.element=document.createElement("button"),this.element.setAttribute("id",t),this.element.innerText=e,this.element.addEventListener("click",n)}appendTo(t){t.appendChild(this.element)}innerText(t){this.element.innerText=t}getElement(){return this.element}setClass(t){this.element.classList.add(t)}setAttribute(t,e){this.element.setAttribute(t,e)}}class N{constructor(t,e,n,i){this.button=document.createElement("button"),this.button.setAttribute("id",t),this.button.addEventListener("click",e),this.image=document.createElement("img"),this.image.src=n,this.image.alt=i??"",this.image.width=30,this.image.height=30,this.button.append(this.image)}appendTo(t){t.appendChild(this.button)}getElement(){return this.button}getImageUrl(){return this.image.src}setImageUrl(t){this.image.src=t}disable(){this.button.disabled=!0}enable(){this.button.disabled=!1}}const J=""+new URL("sound-4TO1uW0K.png",import.meta.url).href,S=""+new URL("soundOn-CMi0u_tW.png",import.meta.url).href,V=""+new URL("undo-DKYIcWbg.png",import.meta.url).href,p=[{id:"addOptionBtn",text:"Add Option"},{id:"pasteListBtn",text:"Paste List"},{id:"clearListBtn",text:"Clear List"},{id:"saveListBtn",text:"Save List to File"},{id:"loadListBtn",text:"Load List from File"},{id:"startBtn",text:"Start"}],E=[{id:"backBtn",imageUrl:V,imageAlt:"Back"},{id:"soundBtn",imageUrl:S,imageAlt:"Sound"},{id:"soundBtn",imageUrl:J,imageAlt:"Sound"}],z=""+new URL("timer-D5zvtUB9.png",import.meta.url).href;class X{constructor(){this.label=document.createElement("label"),this.label.setAttribute("for","timer"),this.image=document.createElement("img"),this.image.src=z,this.image.alt="Timer",this.image.width=30,this.image.height=30,this.label.append(this.image),this.input=document.createElement("input"),this.input.type="number",this.input.name="timer",this.input.id="timer",this.input.classList.add("timer-input"),this.input.min="5",this.input.max="30",this.input.value="10"}appendInputTo(t){t.appendChild(this.input)}appendLabelTo(t){t.appendChild(this.label)}getInput(){return this.input}getLabel(){return this.label}disable(){this.input.disabled=!0,this.label.classList.add("disabled")}enable(){this.input.disabled=!1,this.label.classList.remove("disabled")}}const L=new X;class K{constructor(){this.div=document.createElement("div"),this.div.classList.add("wheel-start"),this.button=document.createElement("button"),this.button.id="startWheelBtn",this.button.classList.add("startWheelBtn"),this.button.innerText="Start",this.button.addEventListener("click",mt),this.div.append(this.button)}getElement(){return this.div}disable(){this.button.disabled=!0}enable(){this.button.disabled=!1}}const A=new K;class G{constructor(){this.div=document.createElement("div"),this.div.classList.add("wheel-text-menu"),this.span=document.createElement("span"),this.span.textContent="Click Start Button",this.div.append(this.span)}append(t){this.div.append(t)}getElement(){return this.div}highlight(){this.div.classList.add("highlight")}deHighlight(){this.div.classList.remove("highlight")}setText(t){this.span.innerText=t}getText(){return this.span.textContent}}const w=new G;class Q{constructor(t=[]){this.isColorsUpdated=!1,this.totalWeight=0,this.colors=[],this.isSpinning=!1,this.canvas=document.createElement("canvas"),this.canvas.width=600,this.canvas.height=600,this.canvas.id="canvas",this.ctx=this.canvas.getContext("2d"),this.isColorsUpdated=!1,this.sections=t,this.rotation=0,this.arrowAngle=Math.PI/2,this.draw()}draw(){this.isSpinning&&(this.getTextAtArrowPosition().length>15?w.setText(this.getTextAtArrowPosition().slice(0,15)+"..."):w.setText(this.getTextAtArrowPosition())),this.isColorsUpdated||this.updateSections();const t=this.canvas.width/2,e=this.canvas.height/2,n=Math.min(t,e)-10;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);let i=this.rotation;this.sections&&this.sections.forEach((o,l)=>{const r=o.weight/this.totalWeight*2*Math.PI;this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.arc(t,e,n,i,i+r),this.ctx.closePath(),this.ctx.fillStyle=this.colors[l].color,this.ctx.fill(),this.ctx.strokeStyle="white",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.closePath(),i+=r}),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.arc(t,e,20,0,Math.PI*2),this.ctx.closePath(),this.ctx.fillStyle="#9370DB",this.ctx.strokeStyle="white",this.ctx.lineWidth=5,this.ctx.stroke(),this.ctx.fill(),i=this.rotation,this.sections&&this.sections.forEach((o,l)=>{const r=o.weight/this.totalWeight*2*Math.PI;if(!(r<=.2)){if(this.ctx.save(),this.ctx.translate(t,e),this.ctx.rotate(i+r/2),this.ctx.strokeStyle="black",this.ctx.fillStyle="white",this.ctx.font="24px Arial",this.ctx.textAlign="center",o.title.length>15){const c=o.title.slice(0,15)+"...";this.ctx.strokeText(c,n/2,5),this.ctx.fillText(c,n/2,5)}else this.ctx.strokeText(o.title,n/2,5),this.ctx.fillText(o.title,n/2,5);this.ctx.closePath()}this.ctx.restore(),i+=r}),this.ctx.strokeStyle="white",this.ctx.fillStyle="#c95dc9",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.shadowColor="rgba(0, 0, 0, 0.5)",this.ctx.shadowBlur=5,this.ctx.shadowOffsetX=3,this.ctx.shadowOffsetY=3,this.ctx.moveTo(t,e/6),this.ctx.lineTo(t-20,1),this.ctx.lineTo(t,10),this.ctx.lineTo(t+20,1),this.ctx.lineTo(t,e/6),this.ctx.fill(),this.ctx.stroke()}spin(t){this.isSpinning=!0;const e=Date.now(),n=e+t*1e3,i=this.rotation,o=Math.random()*100*Math.PI,l=setInterval(()=>{const r=Date.now();if(r>=n){clearInterval(l),this.rotation=i+o,this.draw(),this.enableMenu(),this.isSpinning=!1,h.showWithText(`Your value: ${w.getText()}`),w.highlight(),j.play();return}const c=(r-e)/(t*1e3),I=(b=>b<.5?4*b*b*b:1-Math.pow(-2*b+2,3)/2)(c);this.rotation=i+o*I,this.draw(),this.disableMenu()},16)}updateSections(){this.sections=v(),this.sections&&(this.totalWeight=this.sections.reduce((e,n)=>e+n.weight,0));const t=this.sections;t&&(this.colors=this.generateRandomColor(t.length)),this.isColorsUpdated=!0}generateRandomColor(t){const e=()=>{const i="0123456789ABCDEF";let o="#";for(let l=0;l<6;l++)o+=i[Math.floor(Math.random()*16)];return o},n=[];for(let i=0;i<t;i++)n.push({color:e()});return n}getTextAtArrowPosition(){const t=this.canvas.width/2,e=this.canvas.height/2,n=t,i=e/4,o=n-t,l=i-e,r=Math.atan2(l,o),c=r<0?r+2*Math.PI:r;let x=this.rotation;for(const I of this.sections){const b=I.weight/this.totalWeight*2*Math.PI,W=x+b,B=x%(2*Math.PI),M=W%(2*Math.PI);if(B<=M&&c>=B&&c<=M||B>M&&(c>=B||c<=M))return I.title;x=W}return null}disableMenu(){A.disable(),L.disable(),O.disable(),f.disable()}enableMenu(){A.enable(),L.enable(),O.enable(),f.enable()}getElement(){return this.canvas}}const F=""+new URL("soundOff-DcsLV9L7.png",import.meta.url).href;function Z(){const s=f.getImageUrl().split("/"),t=S.split("/");s[s.length-1]===t[t.length-1]?(localStorage.setItem("sound","false"),f.setImageUrl(F)):(localStorage.setItem("sound","true"),f.setImageUrl(S))}function _(){const s=localStorage.getItem("sound");s===null||s==="true"?f.setImageUrl(S):f.setImageUrl(F)}const tt=v(),y=new Q(tt);class et{constructor(){document.body.remove(),document.body=document.createElement("body")}render(){document.body.remove(),document.body=document.createElement("body"),document.createElement("link");const t=new k,e=new U,n=new R;y.draw(),n.appendToMenu(O.getElement()),n.appendToMenu(f.getElement()),n.appendToMenu(L.getLabel()),n.appendToMenu(L.getInput()),_(),n.append(A.getElement()),n.append(w.getElement()),n.append(y.getElement()),e.append(n.getElement()),t.appendTo(document.body),e.appendTo(document.body),document.body.append(h.getModal())}}function nt(){h.getModal().classList.remove("hidden"),h.showWithText("Please, add at least 2 options.")}function it(){h.getModal().classList.remove("hidden"),h.showWithText("Please, fulfill options Title and Weight.")}function st(s){return s.filter(e=>e.textInputElement.value===""||e.numberInputElement.value==="").length>0}function ot(s){const t=s.split(`
`),e=[];for(const n of t){const i=n.trim();if(!i)continue;const o=i.lastIndexOf(","),l=i.slice(0,o),r=parseInt(i.slice(o+1,i.length));if(isNaN(r)){h.showWithText("Please, enter correct weight value.");continue}e.push({title:l,weight:r})}return e}class at{constructor(){this.dialog=document.createElement("dialog"),this.dialog.classList.add("paste-list-dialog"),this.dialog.addEventListener("click",t=>{t.target===this.dialog&&(u.play(),this.hidePasteListModal())}),this.divContainer=document.createElement("div"),this.divContainer.classList.add("paste-list-container"),this.form=document.createElement("form"),this.form.addEventListener("submit",t=>t.preventDefault()),this.form.classList.add("paste-list-container"),this.divTextarea=document.createElement("div"),this.divButtons=document.createElement("div"),this.divButtons.classList.add("paste-list-buttons-container"),this.confirmButton=new m("confirmBtn","Confirm",()=>xt()),this.confirmButton.setClass("paste-list__btn"),this.cancelButton=new m("cancelBtn","Cancel",()=>this.hidePasteListModal()),this.cancelButton.setClass("paste-list__btn"),this.textarea=document.createElement("textarea"),this.textarea.placeholder=`Paste a list of new options in a CSV-like format:

title, 1                 -> | title                 | 1 |
title with whitespace, 2 -> | title with whitespace | 2 |
title , with , commas, 3 -> | title , with , commas | 3 |
title with "quotes"  4   -> | title with "quotes"   | 4 |
    `,this.textarea.cols=64,this.textarea.rows=12,this.divButtons.append(this.confirmButton.getElement(),this.cancelButton.getElement()),this.divTextarea.append(this.textarea),this.divContainer.append(this.divTextarea),this.divContainer.append(this.divButtons),this.dialog.append(this.divContainer),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.hidePasteListModal()})}getDialog(){return this.dialog}getText(){return this.textarea.value}showPasteListModal(){document.body.append(this.dialog),this.dialog.showModal()}hidePasteListModal(){u.play(),this.textarea.value="",this.dialog.close(),this.dialog.remove()}}const P=new at;function lt(s){return new Promise((t,e)=>{const n=indexedDB.open("MyDatabase",1);n.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains("MyStore")||o.createObjectStore("MyStore",{keyPath:"id"})},n.onsuccess=i=>{const l=i.target.result.transaction("MyStore","readwrite"),r=l.objectStore("MyStore");s.forEach(c=>{r.put(c)}),l.oncomplete=()=>{t()},l.onerror=c=>{e(c.target.error)}},n.onerror=i=>{e(i.target.error)}})}function rt(s,t){const e=JSON.stringify(s,null,2),n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function dt(){return new Promise((s,t)=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=n=>{var l;const i=(l=n.target.files)==null?void 0:l[0];if(!i){t(new Error("Файл не выбран"));return}const o=new FileReader;o.onload=r=>{try{const c=r.target.result,x=JSON.parse(c);d.createList(x),s(x)}catch{t(new Error("Ошибка при чтении файла"))}},o.onerror=()=>{t(new Error("Ошибка при чтении файла"))},o.readAsText(i)},e.click()})}function ct(){u.play();const s=new d;d.options.push(s),s.appendTo(g.getElement()),T(d.options)}function ht(){d.options.length=0,d.index=0,g.removeChild(),T([]),u.play()}function ut(){if(u.play(),d.options.length<2)nt();else if(st(d.options))it();else{T(d.options);const s=new C;y.isColorsUpdated=!1,y.draw(),s.navigate("/wheel")}}function pt(){new C().navigate("/"),u.play()}function mt(){w.deHighlight();const s=parseFloat(L.getInput().value);!isNaN(s)&&s>0&&y.spin(s),u.play()}function gt(){Z(),u.play()}function ft(){P.showPasteListModal(),u.play()}function xt(){u.play();const s=ot(P.getText());for(let t of s){const e=new d;e.setTitleAndWeight(t.title,t.weight),e.appendTo(g.getElement()),d.options.push(e)}P.hidePasteListModal()}async function bt(){u.play(),await T(d.options);const s=await v();await lt(s),await rt(s,"saved-options"),h.showWithText("List of options saved in IndexedDB")}async function wt(){u.play(),dt()}const Et=new m(p[0].id,p[0].text,ct),vt=new m(p[1].id,p[1].text,ft),Lt=new m(p[5].id,p[2].text,ht),yt=new m(p[5].id,p[3].text,bt),Tt=new m(p[5].id,p[4].text,wt),It=new m(p[5].id,p[5].text,ut),O=new N(E[0].id,pt,E[0].imageUrl,E[0].imageAlt),f=new N(E[1].id,gt,E[1].imageUrl,E[1].imageAlt),g=new q;class Bt{constructor(){this.buttons=[],document.body.remove(),document.body=document.createElement("body")}removeBody(){document.body.remove(),document.body=document.createElement("body")}render(){this.removeBody();const t=new k,e=new U,n=new R;n.appendToMenu(Et.getElement()),n.appendToMenu(vt.getElement()),n.appendToMenu(Lt.getElement()),n.appendToMenu(yt.getElement()),n.appendToMenu(Tt.getElement()),n.appendToMenu(It.getElement()),this.renderOptions(),e.append(n.getElement()),n.append(g.getElement()),t.appendTo(document.body),e.appendTo(document.body),document.body.append(h.getModal())}getButtons(){return this.buttons}renderOptions(){const t=v();if(t&&g.getElement().childNodes.length<2)d.createList(t);else if(!(d.options.length===1||g.getElement().childNodes.length>0)){const e=new d;d.options.push(e),e.appendTo(g.getElement())}}}class Mt{constructor(){document.body.remove(),document.body=document.createElement("body"),this.div=document.createElement("div"),this.h2=document.createElement("h2"),this.h2.innerText="This page doesn't exist. Click 'Go to Home page'.",this.h2.classList.add("error-message"),this.router=new C,this.div.append(this.h2)}removeBody(){document.body.remove(),document.body=document.createElement("body")}render(){this.removeBody();const t=new m("backHome","Go to Home page",()=>{this.router.navigate("/")}),e=new k,n=new U;n.append(t.getElement()),document.body.append(e.getElement()),document.body.append(this.div),n.appendTo(document.body)}}class C{constructor(){this.routes={},window.addEventListener("popstate",()=>this.route())}addRoute(t,e){this.routes[t]=e}navigate(t){history.pushState({},"",t),this.route()}getLocation(){return window.location.pathname}route(){const t=window.location.pathname,e=v();if(t==="/wheel")if(!e||e.length<2){this.navigate("/"),h.showWithText("Add at least 2 options to continue.");return}else{new et().render();return}else if(t==="/"||t==="/index.html"){new Bt().render();return}else new Mt().render()}}const St=new C;St.route();
